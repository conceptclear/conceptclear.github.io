---
layout: post
title:  "有限元分析基础理论"
date:   2018-8-26 22:35:56
category: FEA
---

这段时间由于项目原因去了企业教企业员工关于ANSYS的一些操作，虽然说如果只教软件的话，可能对于有限元理论并不是需要那么了解，但是知其然知其所以然，正好趁着这个机会巩固了一下有限元分析的一些基础。

### FEA的基本概念  
有限元分析（Finite Element Analysis, FEA）是现代工程计算中不可忽略的一部分，应用于汽车，飞机，机械部件，桥梁，建筑物等的变形和应力分析中。各类工程问题基本上都可以通过一些常微分方程或者偏微分方程进行求解，但是只有在某些特殊情况下，这些方程的解析解才能够求解得出，在更多的情况下，只能通过计算机采用一些数值计算方法得出足够精度的数值解。对于绝大多数工程问题来说，所需求解的问题是连续的，有少数情况下连续的介质是会自动离散化的，比如桁架结构。对于这类问题，它的几何变形或者是物理响应是可以通过结点位置的变化以及相关物理响应来进行精确求解的，数值解可以简单地用一组有限的数值表示。但是对于大多数常见问题来说，对于没有自动离散化的求解介质，是无法利用一组有限自由度的数值解来表达准确的，对于这类问题来说，数值解可以通过一组采样点和特定的插值方程来进行表示。从数学的角度来看，样本点以及插值方程的选择很多。但是，在工程应用中，有限元方法采用分段插值法，如下所示：  
- **离散化**。通过特定方法在需要求解区域选取一组采样点（节点，nodes），并通过这些节点将连续区域离散化为有限的，具有相同拓扑特征的小部分（单元，elements）。这个过程在ANSYS中对应的就是网格划分（mesh）。
- **选取插值方程**。选取一组多项式方程（形函数，shape function），通过形函数和每个单元的节点值的线性组合表达单元的数值解。
- **建立FEA方程**。当网格划分完成，通过物理关系建立一组具有所有节点值的代数方程，并将所求解问题的自由度作为未知量进行求解。
- **求解节点值**。在求解节点值的同时，自由度也会被求解。
- **得到近似的数值解**。问题的数值解可以通过计算得出的每个节点值以及形函数从而对每个单元的分段插值求解得出。    

通过一个例子来解释一下形函数所建立的插值方法。

<div align="center"><img  src="https://github.com/conceptclear/conceptclear.github.io/raw/master/images/FEA/example.png"></div>

图中显示的是一个2D温度分布的近似解。对于给定的三个点上的温度值T<sub>1</sub>、T<sub>2</sub>、T<sub>3</sub>，可以通过二次插值函数来近似这条温度曲线上每一点的温度值。

可以假设温度分布函数可以表示为下面这个式子:

$$
T=a\xi^2+b\xi^2+c
$$

其中，

$$
\xi\in[-1,1]
$$

这里可以简单看为将这个二次插值函数自变量归一化，使得函数在[-1,1]的范围内变化，那么可以根据三个点处的温度值求解出a，b，c的值来：

$$
T=T_1 \quad when \quad \xi=-1 \\
T=T_2 \quad when \quad \xi=0  \\
T=T_3 \quad when \quad \xi=1
$$

可得：

$$
a=\frac{1}{2}(T_3+T_1)-T_2 \\
b=\frac{1}{2}(T_3-T_1) \\
c=T_2
$$

带入原方程，重新整理可以得到：

$$
\begin{align}
T&=[\frac{1}{2}(T_3+T_1)-T_2]\xi^2+\frac{1}{2}(T_3-T_1)\xi+T_2 \\
&=\frac{1}{2}\xi(\xi-1)T_1-(\xi-1)(\xi+1)T_2+\frac{1}{2}\xi(\xi+1)T_3 \\
&=N_1(\xi)T_1+N_2(\xi)T_2+N_3(\xi)T_3
\end{align}
$$

这里的N<sub>1</sub>，N<sub>2</sub>，N<sub>3</sub>即为三个形函数

$$
N_1(\xi)=\frac{1}{2}\xi(\xi-1);\quad
N_2(\xi)=-(\xi+1)(\xi-1);\quad
N_3(\xi)=\frac{1}{2}\xi(\xi+1)
$$

可以发现，形函数具有以下几个性质：

(a)N<sub>i</sub>(ξ)在节点i的地方恒等于1而在其他节点位置恒等于0。那么实际上形函数可以通过这样的一条性质来直接构造。         
(b)构造出来的三个形函数的和恒等于1，当三个点上的的温度相同时，整条线的温度也恒为定值。

同理，这三个点在实际二维空间中连成的曲线也可以通过这三个形函数来进行构造：

$$
\left\{
    \begin{array}{c}
        x=N_1(\xi)x_1+N_2(\xi)x_2+N_3(\xi)x_3 \\
        y=N_1(\xi)y_1+N_2(\xi)y_2+N_3(\xi)y_3
    \end{array}
\right.
$$

通过给定的三个点就可以构造出整个单元的边界，换句话说就是确定了单元的形状，所以这个函数被称为形函数。通过形函数的插值，我们可以将单元的参数空间与实际分析中的真实空间形成一个映射关系。

### 有限元分析中的典型步骤
有限元分析通常会被划分为三个部分，分别是前处理，求解和后处理。对于每个部分，通常有以下几个步骤：
#### 前处理
- 将所需求解的区域离散化为许多带节点的单元。
- 构造可以通过节点值插值求解的形函数
- 针对每个单元建立方程，组合这些单元从而形成一组代数方程
- 设置边界关系和内部连接关系
#### 求解
- 同步求解代数方程。
- 计算获得节点值的结果，从而得到近似解。
#### 后处理
- 从近似解中计算其他感兴趣的参数。
- 验证，可视化解决方案的感兴趣的方面(应力应变变形温度等的云图)。
- 分析并评估解决方案。

### 有限元分析的优缺点
FEA与其他所有的方法一样，是一个具有两面性的工具，存在着明显的优点和缺点。      
作为一个强大的分析工具，它可以处理复杂的分析类型，如振动，瞬态，非线性，流体等；它可以处理复杂的几何形状和复杂的载荷和边界条件；它可以处理非均质材料，非各向同性材料和特殊材料的温度依赖性和可塑性等效果；它可以处理特殊的几何效应，如大变形。也许FEA最吸引人的特性就是它处理一个复杂的问题就像一个简单的问题一样简单。        
FEA的缺点包括：不像分析结果，它只能给出具体的特定问题的结果；它包含固有的错误（本身对于模型求解的近似舍入等）；它需要经验和判断力才能获得值得信赖的分析；它需要一台功能强大的计算机和可靠的FEA软件包，而这样的硬件软件设备通常很贵；最后，通常需要简化但很难处理。最重要的是，当存在确切的解决方案时，它就变得毫无用处。

### Reference
[1]Moaveni S. Finite Element Analysis:Theory and Applications with ANSYS:[M]. Prentice Hall, 2013.
[2]ANSYS Help

<div id="container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  id: 'FEA_basictheory.href', // 可选。默认为 location.href
  owner: 'conceptclear',
  repo: 'githubpages-comments',
  oauth: {
    client_id: '6a29f84533d3ebc673da',
    client_secret: 'b1537face0afad64fafa7e6fd7169df85b9d9eb2',
  },
})
gitment.render('container')
</script>
